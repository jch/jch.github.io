<!DOCTYPE html>
<html>
<head>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<title>
Modular Cocoa Interfaces
</title>
<link href="../../../../assets/application-1b6070a43c3e8d37df5eb4ad2c23b344.css" media="all" rel="stylesheet" type="text/css" />
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2747647-1']);
  _gaq.push(['_setSiteSpeedSampleRate', 100]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>
<body class='container-fluid'>
<div class='full-width' id='wcc'>
<div id='header'>
<a href="../../../../index.html">whatcodecraves.com</a>
</div>

<div id='main'>
<div id="carbonads-container">
  <div class="carbonad">
    <div id="azcarbon"></div>
      <script type="text/javascript">
        var z = document.createElement("script");
        z.type = "text/javascript";
        z.async = true;
        z.src = "http://engine.carbonads.com/z/17311/azcarbon_2_1_0_VERT";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(z, s);
      </script>
    </div>
  </div>
<div class='post'>
<h1>Modular Cocoa Interfaces</h1>
<a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
<a href="https://twitter.com/share" class="twitter-share-button" data_via="whatcodecraves">Tweet</a>
<div class='g-plus' data-action='share' data-annontation='bubble'></div>
<p>While iOS projects have the advantage of multiple NIB files, this is
not the default for development on OSX. When working on a Mac or iOS
project with more than one person, you quickly learn that attempting
to merge conflicted Interface Builder files or XCode project files can
only result in tears. But just because you can't work on the same NIB
doesn't mean that the productivity of the entire team should be
blocked by the one person editing MainMenu.xib. Cocoa allows you to
chop your UI into separate NIBs and control them with multiple
NSWindowControllers. Once you separate out different windows from
MainMenu, you're much less likely to conflict with your team. As an
added benefit, your UI will feel snappier because NIB loading will be
delayed until it's actually needed. I'll demonstrate this technique by
separating the Preferences window from the main window, a common and
easy case for refactoring.</p><h2>Code</h2><p>For starters, let's create a new NSWindowController subclass for
driving our Preferences window.  We'll name it PreferencesController.</p><p>The header:</p><pre><code>#import &lt;Cocoa/Cocoa.h&gt;
@interface PreferencesController : NSWindowController {
}
@end
</code></pre><p>The implementation:</p><pre><code>#import "PreferencesController.h"
@implementation PreferencesController

- (id) init {
  if(self = [super initWithWindowNibName:@"Preferences"]) {
  }
  return self;
}
</code></pre><p>The only difference from a generic NSWindowController is the custom
constructor. This controller will try to load a NIB named
"Preferences.xib" when it's -showWindow: method is called. In the
Xcode sidebar, right click Resources, Add File, User Interface, and
choose "Window XIB".  Name this xib "Preferences.xib".</p><h2>Interface Builder</h2><p>Next comes the error-prone step.  If you don't add all the right
connections in Interface Builder, then your new window will act
erratically.  It might not show up, it might not be in focus, it might
not close, or it might explode your Mac (unlikely, but not
impossible).  First, add an NSObject to your Document and change the
'Class' to 'PreferencesController'</p><div class="thumbnail"><a href="https://skitch.com/jollyjerry/rg3ir/preferences-controller-identity-2"><img src="https://img.skitch.com/20101227-nmxnxp4na7p8mtgj15ea7ifhmm.preview.jpg" alt="Preferences Controller Identity-2"></a></div><p><br></p><p>To test that our NIB is loading properly, let's connect the
'Preferences' menu item to the showWindow: action.</p><div class="thumbnail"><a href="https://skitch.com/jollyjerry/rg3ix/menu-item-connections"><img src="https://img.skitch.com/20101227-ecupcfjkk6s6nsxiwrpe6deyjy.preview.jpg" alt="Menu Item Connections"></a></div><p><br></p><p>We're almost there, but if you run the app now, you'll notice that the
Preferences window doesn't focus properly. While our "MainMenu.xib"
has a reference to PreferencesController, we forgot to let
Preferences.xib know that its owner is of type PreferencesController.
Open "Preferences.xib", and change "File's Owner" to
PreferencesController, and also set its "window" connection to point
to the window.</p><div class="thumbnail"><a href="https://skitch.com/jollyjerry/rg3ii/preferences-controller-connections"><img src="https://img.skitch.com/20101227-qdrtdix38yxr41bp78583wjifm.preview.jpg" alt="Preferences Controller Connections"></a></div><p><br></p><p>If you Build and Run the project now, you should be able to open the
Preferences window from the menu and have the 2nd Preferences window
loaded. Open and close the Preference window a few times for good
measure too.  If something is acting funny, the most likely culprit is
a missing connection for "File's Owner" in "MainMenu.xib" or a missing
connection for the menu. Go over the steps again and recheck your
class identities and connections (cmd-5) in the inspector to make sure
everything is wired correctly.</p><h2>What's Next?</h2><p>From here, whenever you need to make changes to the Preferences
window, no changes need to be introduced to "MainMenu.xib". Controller
actions can be specified on PreferencesController, and Interface
Builder can access those actions by making connections to "File's
Owner". For a demo, check out <a href="https://github.com/jch/cocoa-separate-nib-preferences">this account preferences
demo</a>.
Hopefully, you can use this process in your project to cut down on
nasty merges.</p><h2>Resources</h2><ul>
<li>
<a href="https://github.com/jch/cocoa-separate-nib-preferences">Account Preferences Example</a> - a more fleshed out version of this article.</li>
<li>
<a href="http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/WinPanel/WinPanel.html">Window Programming Guide</a> - best starting place for anything related to windows.</li>
<li><a href="http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/WinPanel/Concepts/UsingWindowController.html">NSWindowController description</a></li>
<li>
<a href="http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindowController_Class/Reference/Reference.html">NSWindowController Class Reference</a> - as always, Apple's docs are a good place to start</li>
<li>
<a href="http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Documents/Documents.html#//apple_ref/doc/uid/10000006i">Introduction to Document-Based Applications Overview</a> - looking at the Document architecture helps give you an understanding of how Window controllers and NIBs interact.</li>
</ul>
</div>
<script src="../../../../assets/post-6db30d9cd8415ddc540433d54a06699e.js" type="text/javascript"></script>
<script>
  //<![CDATA[
    hljs.initHighlightingOnLoad();
  //]]>
</script>
<script type='text/javascript'>
  // HackerNews
  (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.src = '//hnbutton.appspot.com/static/hn.js';
    s.parentNode.insertBefore(g, s);
  }(document, 'script'));

  // Twitter
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

  // Google Plus
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname  = 'whatcodecraves';
  var disqus_title      = 'Modular Cocoa Interfaces';
  var disqus_identifier = '/articles/2011/01/05/modular-cocoa-interfaces';


  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>
<div id='footer'>
<p>
Copyright Jerry Cheung 2007 - 2014 &nbsp;&nbsp;
<a href="https://github.com/jch/whatcoderaves.com">Source for this blog</a>
</p>
</div>
</div>
</body>
</html>
